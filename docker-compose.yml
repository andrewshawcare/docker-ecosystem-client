version: "2"
volumes:
  database-data:
services:
  docker-ecosystem-client:
    image: ${IMAGE_REGISTRY}/docker-ecosystem-client:${IMAGE_VERSION}
    build: .
    ports:
      - '80:80'
    depends_on:
      - java-service
      - node-service
  java-service:
    image: andrewshawcare/docker-ecosystem-java-service
    ports:
      - 4567:4567
    links:
      - database
    depends_on:
      - migration
  node-service:
    image: andrewshawcare/docker-ecosystem-node-service
    ports:
      - 5678:5678
    links:
      - database
    depends_on:
      - migration
  migration:
    image: andrewshawcare/docker-ecosystem-migration
    links:
      - database
  database:
    image: postgres:9.5.1
    volumes:
      - database-data:/var/lib/postgres/data
